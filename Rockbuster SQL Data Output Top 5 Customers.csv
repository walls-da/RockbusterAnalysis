count,country,total_spent,avg_spent_per_customer,,SQL Script,,,
638,Russian Federation,2765.62,4.33,,SELECT ,,,
681,Brazil,2919.19,4.29,,,"COUNT(customer.customer_id),",,
351,Turkey,1498.49,4.27,,,"country.country,",,
1422,India,6034.78,4.24,,,"SUM(payment.amount) AS total_spent,",,
869,United States,3685.31,4.24,,,SUM(payment.amount)/COUNT(customer.customer_id) AS avg_spent_per_customer,,
530,Philippines,2219.7,4.19,,FROM customer,,,
749,Japan,3122.51,4.17,,,JOIN payment ON customer.customer_id = payment.customer_id,,
718,Mexico,2984.82,4.16,,,JOIN address ON customer.address_id = address.address_id,,
331,Indonesia,1352.69,4.09,,,JOIN city ON address.city_id = city.city_id,,
1297,China,5251.03,4.05,,,JOIN country ON city.country_id = country.country_id,,
,,,,,WHERE country.country IN (,,,
,,,,,,,SELECT country.country,
,,,,,,,FROM customer,
,,,,,,,,JOIN address ON customer.address_id = address.address_id
,,,,,,,,JOIN city ON address.city_id = city.city_id
,,,,,,,,JOIN country ON city.country_id = country.country_id
,,,,,,,GROUP BY country.country,
,,,,,,,ORDER BY count(customer.customer_id)DESC,
,,,,,,,LIMIT 10,
,,,,,,,),
,,,,,GROUP BY country,,,
,,,,,ORDER BY avg_spent_per_customer DESC,,,
,,,,,LIMIT 10;,,,
